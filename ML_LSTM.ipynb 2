
{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "***This notebook is mainly written by Yuan and Yoyo for the end-of-semester project of Machine Learning, Fall 2020***\n"
   ]
  },
  {
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from keras.models import Sequential\n",
    "from keras.layers import Dense, Dropout, Activation, Flatten, LSTM, TimeDistributed, RepeatVector\n",
    "from keras.layers.normalization import BatchNormalization\n",
    "from keras.optimizers import Adam\n",
    "from keras.callbacks import EarlyStopping, ModelCheckpoint\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "load data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>datetime</th>\n",
       "      <th>visitor_outflow</th>\n",
       "      <th>pop_outflow</th>\n",
       "      <th>visitor_inflow</th>\n",
       "      <th>pop_inflow</th>\n",
       "      <th>negative</th>\n",
       "      <th>positive</th>\n",
       "      <th>totalTestResults</th>\n",
       "      <th>allbed_mean</th>\n",
       "      <th>ICUbed_mean</th>\n",
       "      <th>InvVen_mean</th>\n",
       "      <th>admis_mean</th>\n",
       "      <th>newICU_mean</th>\n",
       "      <th>mobility_composite</th>\n",
       "      <th>total_pop</th>\n",
       "      <th>death</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-04-02</td>\n",
       "      <td>911906</td>\n",
       "      <td>9566649</td>\n",
       "      <td>904113</td>\n",
       "      <td>9582535</td>\n",
       "      <td>7503</td>\n",
       "      <td>1233</td>\n",
       "      <td>8736</td>\n",
       "      <td>224.946291</td>\n",
       "      <td>81.876268</td>\n",
       "      <td>57.296591</td>\n",
       "      <td>15.312697</td>\n",
       "      <td>7.590339</td>\n",
       "      <td>-35.207619</td>\n",
       "      <td>4977688.275</td>\n",
       "      <td>6</td>\n",
       "      <td>32.318231</td>\n",
       "      <td>-86.902298</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-04-03</td>\n",
       "      <td>974948</td>\n",
       "      <td>10292520</td>\n",
       "      <td>969556</td>\n",
       "      <td>10335855</td>\n",
       "      <td>8187</td>\n",
       "      <td>1432</td>\n",
       "      <td>9619</td>\n",
       "      <td>246.399825</td>\n",
       "      <td>89.349936</td>\n",
       "      <td>62.432738</td>\n",
       "      <td>16.178042</td>\n",
       "      <td>8.042432</td>\n",
       "      <td>-35.667289</td>\n",
       "      <td>4977688.275</td>\n",
       "      <td>3</td>\n",
       "      <td>32.318231</td>\n",
       "      <td>-86.902298</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2020-04-04</td>\n",
       "      <td>854480</td>\n",
       "      <td>9205708</td>\n",
       "      <td>852529</td>\n",
       "      <td>9277032</td>\n",
       "      <td>9273</td>\n",
       "      <td>1580</td>\n",
       "      <td>10853</td>\n",
       "      <td>266.754599</td>\n",
       "      <td>96.413430</td>\n",
       "      <td>67.261197</td>\n",
       "      <td>16.916438</td>\n",
       "      <td>8.432862</td>\n",
       "      <td>-36.044666</td>\n",
       "      <td>4977688.275</td>\n",
       "      <td>8</td>\n",
       "      <td>32.318231</td>\n",
       "      <td>-86.902298</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-04-05</td>\n",
       "      <td>699333</td>\n",
       "      <td>7848208</td>\n",
       "      <td>696765</td>\n",
       "      <td>7892404</td>\n",
       "      <td>11282</td>\n",
       "      <td>1796</td>\n",
       "      <td>13078</td>\n",
       "      <td>273.266913</td>\n",
       "      <td>97.884635</td>\n",
       "      <td>68.174187</td>\n",
       "      <td>17.527168</td>\n",
       "      <td>8.760063</td>\n",
       "      <td>-36.334809</td>\n",
       "      <td>4977688.275</td>\n",
       "      <td>2</td>\n",
       "      <td>32.318231</td>\n",
       "      <td>-86.902298</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-04-06</td>\n",
       "      <td>815949</td>\n",
       "      <td>9098459</td>\n",
       "      <td>809844</td>\n",
       "      <td>9118196</td>\n",
       "      <td>12797</td>\n",
       "      <td>1968</td>\n",
       "      <td>14765</td>\n",
       "      <td>287.322866</td>\n",
       "      <td>101.783974</td>\n",
       "      <td>70.768875</td>\n",
       "      <td>18.017711</td>\n",
       "      <td>9.026577</td>\n",
       "      <td>-36.532078</td>\n",
       "      <td>4977688.275</td>\n",
       "      <td>5</td>\n",
       "      <td>32.318231</td>\n",
       "      <td>-86.902298</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    datetime  visitor_outflow  pop_outflow  visitor_inflow  pop_inflow  \\\n",
       "0 2020-04-02           911906      9566649          904113     9582535   \n",
       "1 2020-04-03           974948     10292520          969556    10335855   \n",
       "2 2020-04-04           854480      9205708          852529     9277032   \n",
       "3 2020-04-05           699333      7848208          696765     7892404   \n",
       "4 2020-04-06           815949      9098459          809844     9118196   \n",
       "\n",
       "   negative  positive  totalTestResults  allbed_mean  ICUbed_mean  \\\n",
       "0      7503      1233              8736   224.946291    81.876268   \n",
       "1      8187      1432              9619   246.399825    89.349936   \n",
       "2      9273      1580             10853   266.754599    96.413430   \n",
       "3     11282      1796             13078   273.266913    97.884635   \n",
       "4     12797      1968             14765   287.322866   101.783974   \n",
       "\n",
       "   InvVen_mean  admis_mean  newICU_mean  mobility_composite    total_pop  \\\n",
       "0    57.296591   15.312697     7.590339          -35.207619  4977688.275   \n",
       "1    62.432738   16.178042     8.042432          -35.667289  4977688.275   \n",
       "2    67.261197   16.916438     8.432862          -36.044666  4977688.275   \n",
       "3    68.174187   17.527168     8.760063          -36.334809  4977688.275   \n",
       "4    70.768875   18.017711     9.026577          -36.532078  4977688.275   \n",
       "\n",
       "   death   latitude  longitude  \n",
       "0      6  32.318231 -86.902298  \n",
       "1      3  32.318231 -86.902298  \n",
       "2      8  32.318231 -86.902298  \n",
       "3      2  32.318231 -86.902298  \n",
       "4      5  32.318231 -86.902298  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv('/Users/zhangyumeng/Desktop/all_us_data4.csv')   \n",
    "df = df.drop(columns = 'location_name')\n",
    "df[\"datetime\"] = pd.to_datetime(df[\"datetime\"])\n",
    "#df = df.set_index(['datetime'], drop=True)\n",
    "#    df = df.groupby('datetime').sum().reset_index()\n",
    "#    df = df[['datetime','daily_death']]\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Add dumy as colunms"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "def augFeatures(data):\n",
    "#  train[\"year\"] = train[\"datetime\"].dt.year\n",
    "    data[\"month\"] = data[\"datetime\"].dt.month\n",
    "    data[\"date\"] = data[\"datetime\"].dt.day\n",
    "    data[\"day\"] = data[\"datetime\"].dt.dayofweek\n",
    "    return data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Split data to training dataset and validation dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "def splitData(X,Y,rate):\n",
    "    \n",
    "    X_train = X[int(X.shape[0]*rate):]\n",
    "    Y_train = Y[int(Y.shape[0]*rate):]\n",
    "    X_val = X[:int(X.shape[0]*rate)]\n",
    "    Y_val = Y[:int(Y.shape[0]*rate)]\n",
    "    \n",
    "    return X_train, Y_train, X_val, Y_val"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "def normalize(df):\n",
    "    scaler = StandardScaler()\n",
    "    columns = df.columns[2:]\n",
    "    df_variables = df.iloc[:, 2:]\n",
    "    df_normalized = pd.DataFrame(scaler.fit_transform(df_variables))\n",
    "    df_normalized.columns = columns\n",
    "    #df_normalized.insert(0, 'location_name', pd.Series(df['location_name']))\n",
    "    #df_normalized.insert(0, 'datetime', pd.Series(df['datetime']))\n",
    "    return df_normalized"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "def Inverse_nomalise(before,after):\n",
    "    result = []\n",
    "    result.append((float(after[i]) + 1 ) * float(before[i]))\n",
    "    return result  "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Create a training dataset that usable by Keras LSTM model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "def buildTrain(train, pastDay=10, futureDay=1):\n",
    "    \n",
    "    X_train, Y_train = [], []\n",
    "    for i in range(train.shape[0]-futureDay-pastDay):\n",
    "        X_train.append(np.array(train.iloc[i:i+pastDay]))\n",
    "        Y_train.append(np.array(train.iloc[i+pastDay:i+pastDay+futureDay][\"death\"]))\n",
    "    return np.array(X_train), np.array(Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "def shuffle(X,Y):\n",
    "    \n",
    "    np.random.seed(10)\n",
    "    randomList = np.arange(X.shape[0])\n",
    "    np.random.shuffle(randomList)\n",
    "    return X[randomList], Y[randomList]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "def buildManyToOneModel(shape):\n",
    "    \n",
    "    model = Sequential()\n",
    "    model.add(LSTM(40, activation='softmax',input_shape=(X_train.shape[1], X_train.shape[2]), return_sequences=False))\n",
    "    model.add(Dense(1, activation='linear'))\n",
    "    opt = Adam(learning_rate=0.01)\n",
    "    model.compile(loss='mean_squared_error', optimizer=opt) \n",
    "    model.summary()\n",
    "    return model\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"sequential_1\"\n",
      "_________________________________________________________________\n",
      "Layer (type)                 Output Shape              Param #   \n",
      "=================================================================\n",
      "lstm_1 (LSTM)                (None, 40)                9600      \n",
      "_________________________________________________________________\n",
      "dense_1 (Dense)              (None, 1)                 41        \n",
      "=================================================================\n",
      "Total params: 9,641\n",
      "Trainable params: 9,641\n",
      "Non-trainable params: 0\n",
      "_________________________________________________________________\n",
      "Epoch 1/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.5776 - val_loss: 0.6585\n",
      "Epoch 2/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.3921 - val_loss: 0.5144\n",
      "Epoch 3/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.3272 - val_loss: 0.4729\n",
      "Epoch 4/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.2794 - val_loss: 0.4227\n",
      "Epoch 5/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.2440 - val_loss: 0.3759\n",
      "Epoch 6/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.2455 - val_loss: 0.3660\n",
      "Epoch 7/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.2112 - val_loss: 0.3580\n",
      "Epoch 8/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1928 - val_loss: 0.3326\n",
      "Epoch 9/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1960 - val_loss: 0.3520\n",
      "Epoch 10/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1780 - val_loss: 0.3280\n",
      "Epoch 11/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1706 - val_loss: 0.3265\n",
      "Epoch 12/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1673 - val_loss: 0.3254\n",
      "Epoch 13/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1657 - val_loss: 0.3110\n",
      "Epoch 14/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1600 - val_loss: 0.3000\n",
      "Epoch 15/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1537 - val_loss: 0.2956\n",
      "Epoch 16/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1520 - val_loss: 0.2827\n",
      "Epoch 17/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1883 - val_loss: 0.3869\n",
      "Epoch 18/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.2020 - val_loss: 0.3722\n",
      "Epoch 19/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1858 - val_loss: 0.2775\n",
      "Epoch 20/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1375 - val_loss: 0.2569\n",
      "Epoch 21/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1394 - val_loss: 0.2556\n",
      "Epoch 22/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1298 - val_loss: 0.2521\n",
      "Epoch 23/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1282 - val_loss: 0.2468\n",
      "Epoch 24/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1227 - val_loss: 0.2427\n",
      "Epoch 25/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1150 - val_loss: 0.2408\n",
      "Epoch 26/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1198 - val_loss: 0.2400\n",
      "Epoch 27/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1161 - val_loss: 0.2525\n",
      "Epoch 28/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1192 - val_loss: 0.2494\n",
      "Epoch 29/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1194 - val_loss: 0.2334\n",
      "Epoch 30/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1332 - val_loss: 0.3278\n",
      "Epoch 31/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1602 - val_loss: 0.3190\n",
      "Epoch 32/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1508 - val_loss: 0.3149\n",
      "Epoch 33/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1475 - val_loss: 0.3095\n",
      "Epoch 34/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1405 - val_loss: 0.2985\n",
      "Epoch 35/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1375 - val_loss: 0.2961\n",
      "Epoch 36/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1400 - val_loss: 0.2964\n",
      "Epoch 37/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1327 - val_loss: 0.2854\n",
      "Epoch 38/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1251 - val_loss: 0.3017\n",
      "Epoch 39/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1248 - val_loss: 0.2747\n",
      "Epoch 40/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1241 - val_loss: 0.2828\n",
      "Epoch 41/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1221 - val_loss: 0.2861\n",
      "Epoch 42/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1199 - val_loss: 0.2807\n",
      "Epoch 43/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1210 - val_loss: 0.2676\n",
      "Epoch 44/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1175 - val_loss: 0.2700\n",
      "Epoch 45/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1122 - val_loss: 0.2719\n",
      "Epoch 46/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1107 - val_loss: 0.2628\n",
      "Epoch 47/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1138 - val_loss: 0.2636\n",
      "Epoch 48/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1094 - val_loss: 0.2725\n",
      "Epoch 49/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1068 - val_loss: 0.2668\n",
      "Epoch 50/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1057 - val_loss: 0.2554\n",
      "Epoch 51/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1029 - val_loss: 0.2539\n",
      "Epoch 52/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1020 - val_loss: 0.2692\n",
      "Epoch 53/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1061 - val_loss: 0.2504\n",
      "Epoch 54/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.1018 - val_loss: 0.2568\n",
      "Epoch 55/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1023 - val_loss: 0.2519\n",
      "Epoch 56/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1045 - val_loss: 0.2495\n",
      "Epoch 57/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0976 - val_loss: 0.2522\n",
      "Epoch 58/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.1001 - val_loss: 0.2464\n",
      "Epoch 59/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0958 - val_loss: 0.2520\n",
      "Epoch 60/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0965 - val_loss: 0.2443\n",
      "Epoch 61/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0963 - val_loss: 0.2537\n",
      "Epoch 62/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0932 - val_loss: 0.2508\n",
      "Epoch 63/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0930 - val_loss: 0.2535\n",
      "Epoch 64/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0960 - val_loss: 0.2451\n",
      "Epoch 65/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0941 - val_loss: 0.2503\n",
      "Epoch 66/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0904 - val_loss: 0.2514\n",
      "Epoch 67/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0899 - val_loss: 0.2398\n",
      "Epoch 68/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0887 - val_loss: 0.2396\n",
      "Epoch 69/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0928 - val_loss: 0.2541\n",
      "Epoch 70/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0889 - val_loss: 0.2411\n",
      "Epoch 71/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0872 - val_loss: 0.2485\n",
      "Epoch 72/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0884 - val_loss: 0.2366\n",
      "Epoch 73/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0884 - val_loss: 0.2381\n",
      "Epoch 74/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0861 - val_loss: 0.2452\n",
      "Epoch 75/100\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0851 - val_loss: 0.2396\n",
      "Epoch 76/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0889 - val_loss: 0.2348\n",
      "Epoch 77/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0821 - val_loss: 0.2410\n",
      "Epoch 78/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.0812 - val_loss: 0.2350\n",
      "Epoch 79/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.0871 - val_loss: 0.2379\n",
      "Epoch 80/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.0889 - val_loss: 0.2378\n",
      "Epoch 81/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0852 - val_loss: 0.2379\n",
      "Epoch 82/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0835 - val_loss: 0.2328\n",
      "Epoch 83/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0804 - val_loss: 0.2367\n",
      "Epoch 84/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0809 - val_loss: 0.2325\n",
      "Epoch 85/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0810 - val_loss: 0.2435\n",
      "Epoch 86/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.0821 - val_loss: 0.2332\n",
      "Epoch 87/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0794 - val_loss: 0.2350\n",
      "Epoch 88/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0825 - val_loss: 0.2281\n",
      "Epoch 89/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0800 - val_loss: 0.2355\n",
      "Epoch 90/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0835 - val_loss: 0.2393\n",
      "Epoch 91/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0825 - val_loss: 0.2356\n",
      "Epoch 92/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0818 - val_loss: 0.2460\n",
      "Epoch 93/100\n",
      "257/257 [==============================] - 1s 4ms/step - loss: 0.0874 - val_loss: 0.2338\n",
      "Epoch 94/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0846 - val_loss: 0.2411\n",
      "Epoch 95/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0829 - val_loss: 0.2441\n",
      "Epoch 96/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0834 - val_loss: 0.2371\n",
      "Epoch 97/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0793 - val_loss: 0.2443\n",
      "Epoch 98/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0786 - val_loss: 0.2458\n",
      "Epoch 99/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0817 - val_loss: 0.2347\n",
      "Epoch 100/100\n",
      "257/257 [==============================] - 1s 5ms/step - loss: 0.0765 - val_loss: 0.2334\n"
     ]
    }
   ],
   "source": [
    "df = augFeatures(df)\n",
    "df = normalize(df)\n",
    "X,Y = buildTrain(df)\n",
    "X_train, Y_train = shuffle(X, Y)\n",
    "X_train, Y_train, X_val, Y_val = splitData(X_train, Y_train, 0.25)\n",
    "model = buildManyToOneModel(X_train.shape)\n",
    "LSTM = model.fit(X_train,Y_train, epochs=100, batch_size=32, validation_data=(X_val, Y_val))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Plot Train and Valida datasets MSE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(LSTM.history['loss'], label='train')\n",
    "plt.plot(LSTM.history['val_loss'], label='valid')\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "def predict_point_by_point(model, data):\n",
    "    predicted = model.predict(data)\n",
    "    print('predicted shape:',np.array(predicted).shape) \n",
    "    predicted = np.reshape(predicted, (predicted.size,))\n",
    "    return predicted"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "predicted shape: (8216, 1)\n",
      "predicted shape: (2738, 1)\n",
      "MSE_train: 0.07131692458879947\n",
      "MSE_val: 0.23341304916532163\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import mean_squared_error\n",
    "MSE_train = mean_squared_error(Y_train, predict_point_by_point(model, X_train))\n",
    "MSE_val   = mean_squared_error(Y_val, predict_point_by_point(model, X_val))\n",
    "print('MSE_train:', MSE_train)\n",
    "print('MSE_val:', MSE_val)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
